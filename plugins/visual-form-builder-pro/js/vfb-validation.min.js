jQuery(document).ready(function(d){d(".visual-form-builder").each(function(){d(this).validate({rules:{recaptcha_response_field:{required:true}},onkeyup:function(i){if(i.type=="password"){this.element(i)}else{return true}},errorClass:"vfb-error",errorPlacement:function(i,j){if((j.is(":radio")||j.is(":checkbox"))&&!j.hasClass("vfb-likert-option")){i.appendTo(j.parent().parent())}else{if(j.is(":password")){i.hide()}else{if("recaptcha_response_field"==j.attr("id")){i.insertAfter("#recaptcha_table")}else{if(j.hasClass("vfb-likert-option")){i.insertAfter(j.closest("tr"))}else{i.insertAfter(j)}}}}}})});d(".visual-form-builder li:not(.vfb-item-instructions li, .vfb-span li)").filter(function(){return d(this).css("list-style-type")!=="none"}).css("list-style","none");d(".vfb-date-picker").each(function(){var i=d(this).attr("data-dp-dateFormat")?d(this).attr("data-dp-dateFormat"):"mm/dd/yy";d(this).datepicker({dateFormat:i})});if(d(".vfb-page #sendmail").is(":visible")){d(".vfb-page #sendmail").prop("disabled",false)}else{d(".vfb-page #sendmail").prop("disabled","disabled")}d(document).on("click",".vfb-page-next",function(k){k.preventDefault();var l=d(this).attr("id"),j=parseInt(l.replace(/page-/,"")),i="#"+d(this).parents("form.visual-form-builder").attr("id");if(!d(i).valid()){return}d(".page-"+j).fadeIn();d("html, body").animate({scrollTop:d(".page-"+j).offset().top-50});d(this).fadeOut();if(d(".vfb-page #sendmail").is(":visible")){d(".vfb-page #sendmail").prop("disabled",false)}else{d(".vfb-page #sendmail").prop("disabled","disabled")}});d(".colorPicker").each(function(){var i=d(this).attr("id").match(new RegExp(/(\d+)$/g),"");d(this).farbtastic("#vfb-"+i)});d(".colorPicker").hide();d(".vfb-color-picker:input").focus(function(){var i=d(this).attr("id").match(new RegExp(/(\d+)$/g),"");d("#vfb-colorPicker-"+i).show()}).blur(function(){var i=d(this).attr("id").match(new RegExp(/(\d+)$/g),"");d("#vfb-colorPicker-"+i).hide()});d(".auto").each(function(){var i=d(this).closest("form").find('input[name="form_id"]').val();var j=d(this).attr("id").match(new RegExp(/(\d+)$/g),"");d("#"+d(this).attr("id")).autocomplete({delay:200,source:function(l,k){d.ajax({url:VfbAjax.ajaxurl,type:"GET",async:true,cache:false,dataType:"json",data:{action:"visual_form_builder_autocomplete",term:l.term,form:i,field:j[0]},success:function(m){k(d.map(m,function(n){return{value:n.value}}))}})}})});if(window.VfbRules){var g=d.parseJSON(VfbRules.rules);var c=[];e(g);d(g).each(function(){d.each(this.rules,function(j){c.push("[name^=vfb-"+this.field+"]")})});d(c.join(",")).change(function(){e(g)})}function f(m,l){var j=d("[name^=vfb-"+m+"]");if(j.length>0){for(var k=0;k<j.length;k++){if(d(j[k]).is("[type=checkbox],[type=radio]")){if(a(d(j[k]).val())==l&&d(j[k]).is(":checked")){return true}}else{if(d(j[k]).is("select")){if(a(d(j[k]).val())==l){return true}}}}}else{if(a(d("[name^=vfb-"+m+"]").val())==l){return true}}return false}function a(i){if(!i){return""}var i=i.split("|");return i[0]}function e(i){d(i).each(function(){var m=this.field_id,p="item-vfb-"+m,k=this.conditional_show,o=this.rules,l=this.conditional_logic,n=0,j="";j=(k=="show")?"hide":"show";d.each(o,function(q){this.option=this.option.replace("\\","");if((this.condition=="is"&&f(this.field,this.option))||(this.condition=="isnot"&&!f(this.field,this.option))){n++}});if((l=="all"&&n==o.length)||(l=="any"&&n>0)){d("[id="+p+"]")[k]()}else{d("[id="+p+"]")[j]()}if(!d("#"+p).is(":visible")){d("#"+p+" :input").prop("disabled","disabled")}else{d("#"+p+" :input").prop("disabled",false)}})}d(".vfb-textarea-word-count").keyup(function(){var l={},k=b(this.value),i=k.match(/\b/gi),j=0;l[this.id]=i?i.length/2:0;d.each(l,function(n,m){j+=m});d(this).parent().find(".vfb-word-count-total").text(j)});function h(i){return i.replace(/<.[^<>]*?>/g," ").replace(/&nbsp;|&#160;/gi," ").replace(/[.(),;:!?%#$'"_+=\/-]*/g,"")}function b(i){return i.replace(/[\u00E1\u00E2\u00E4\u00E6\u00E3\u00E5\u0101]+/gi,"a").replace(/[\u00E7\u0107\u010D]+/gi,"c").replace(/[\u00E8\u00E9\u00EA\u00EB\u0113\u0117\u0119]+/gi,"e").replace(/[\u00F4\u00F6\u00F2\u00F3\u0153\u00F8\u014D\u00F5]+/gi,"o").replace(/[\u00DF\u015B\u0161Ss]+/gi,"s").replace(/[\u00FB\u00FC\u00F9\u00FA\u016B]+/gi,"u").replace(/[\u00FF]+/gi,"y").replace(/[\u017E\u017A\u017C]+/gi,"z")}d.validator.addMethod("vfbUsername",function(k,j){var i=true;if(k.length>0){d.ajax({url:VfbAjax.ajaxurl,type:"GET",async:false,cache:false,dataType:"text",data:{action:"visual_form_builder_check_username",username:k},success:function(l){i=(l=="true")?true:false}})}return this.optional(j)||i},d.validator.messages.vfbUsername);d.validator.addMethod("phone",function(j,i){j=j.replace(/[\+\s\(\)\.\-\ ]/g,"");return this.optional(i)||j.length>9&&j.match(/^((\+)?[1-9]{1,2})?([-\s\.])?((\(\d{1,4}\))|\d{1,4})(([-\s\.])?[0-9]{1,12}){1,2}$/)},d.validator.messages.phone);d.validator.addMethod("ipv4",function(j,i){return this.optional(i)||/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/i.test(j)},d.validator.messages.ipv4);d.validator.addMethod("ipv6",function(j,i){return this.optional(i)||/^((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))$/i.test(j)},d.validator.messages.ipv6);d.validator.addMethod("maxWords",function(j,i,k){return this.optional(i)||h(b(j)).match(/\b\w+\b/g).length<=k},d.validator.messages.maxWords);d.validator.addMethod("minWords",function(j,i,k){return this.optional(i)||h(b(j)).match(/\b\w+\b/g).length>=k},d.validator.messages.minWords);d.validator.addMethod("rangeWords",function(l,i,m){var k=h(b(l));var j=/\b\w+\b/g;return this.optional(i)||k.match(j).length>=m[0]&&k.match(j).length<=m[1]},d.validator.messages.rangeWords);d.validator.addMethod("alphanumeric",function(j,i){return this.optional(i)||/^\w+$/i.test(j)},d.validator.messages.alphanumeric);d.validator.addMethod("lettersonly",function(j,i){return this.optional(i)||/^[a-z]+$/i.test(j)},d.validator.messages.lettersonly);d.validator.addMethod("nowhitespace",function(j,i){return this.optional(i)||/^\S+$/i.test(j)},d.validator.messages.nowhitespace);d.validator.addMethod("ziprange",function(j,i){return this.optional(i)||/^90[2-5]\d\{2\}-\d{4}$/.test(j)},d.validator.messages.ziprange);d.validator.addMethod("zipcodeUS",function(j,i){return this.optional(i)||/\d{5}-\d{4}$|^\d{5}$/.test(j)},d.validator.messages.zipcodeUS);d.validator.addMethod("integer",function(j,i){return this.optional(i)||/^-?\d+$/.test(j)},d.validator.messages.ziprange)});(function(f){var b=/[a-z]/,g=/[A-Z]/,e=/[0-9]/,i=/[0-9].*[0-9]/,a=/[^a-zA-Z0-9]/,h=/^(.)\1+$/;function d(j,k){return{rate:j,messageKey:k}}function c(j){return j.substring(0,1).toLowerCase()+j.substring(1)}f.validator.passwordRating=function(l,p){if(!l||l.length<8){return d(0,"too-short")}if(p&&l.toLowerCase().match(p.toLowerCase())){return d(0,"similar-to-username")}if(h.test(l)){return d(1,"very-weak")}var k=b.test(l),m=g.test(c(l)),o=e.test(l),n=i.test(l),j=a.test(l);if(k&&m&&o||k&&n||m&&n||j){return d(4,"strong")}if(k&&m||k&&o||m&&o){return d(3,"good")}return d(2,"weak")};f.validator.passwordRating.messages={"similar-to-username":"Too similar to username","too-short":"Too short","very-weak":"Very weak",weak:"Weak",good:"Good",strong:"Strong"};f.validator.addMethod("password",function(n,k,o){var j=k.value,p=f(typeof o!="boolean"?o:[]);var l=f.validator.passwordRating(j,p.val());var m=f(".password-meter",k.form);m.removeClass("similar-to-username too-short very-weak weak good strong").addClass(l.messageKey).text(f.validator.passwordRating.messages[l.messageKey]);if(this.optional(k)){m.removeClass("similar-to-username too-short very-weak weak good strong").text("Password Strength");return true}return l.rate>2},"&nbsp;");f.validator.classRuleSettings.password={password:true}})(jQuery);